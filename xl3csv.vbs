Option Explicit Dim objExcel, objWorkbook Dim objSheet Dim WshShell, regcommand, htmlelement, splits, sections Dim FSO, strCurDir Dim regkey, compname, newregkey, strLine, oShell Dim servicescomm, servicescommsplit, servicesval, newservices, servicescommand, servicesstart Dim strExcelFileName, strScript, strScriptPath, objXL, sheet, oExec, wShell Const adOpenStatic = 3 Const adLockOptimistic = 3 Set oShell = CreateObject ("WScript.Shell") strCurDir = oShell.CurrentDirectory oShell.run "cmd /c del """& strCurDir &"\*.csv""" WScript.Sleep 1000 Set wShell=CreateObject("WScript.Shell") Set oExec=wShell.Exec("mshta.exe ""about:<input type=file id=FILE><script>FILE.click();new ActiveXObject('Scripting.FileSystemObject').GetStandardStream(1).WriteLine(FILE.value);close();resizeTo(0,0);</script>""") strExcelFileName = oExec.StdOut.ReadLine 'strExcelFileName = strCurDir &"\Event details.xlsx" 'file name to parses Set FSO =CreateObject("scripting.FileSystemObject") strScript = Wscript.ScriptFullName Set objXL = CreateObject("Excel.Application") Set objWorkBook = objXL.Workbooks.Open(strExcelFileName) objXL.DisplayAlerts = False 'rem loop over worksheets For Each sheet In objWorkBook.Sheets 'only saveAS sheets that are NOT empty if objXL.Application.WorksheetFunction.CountA(sheet.Cells) <> 0 Then 		sheet.SaveAs strCurDir & "\Event details.csv", 6 'CSV End If Next WScript.Sleep 5000 objWorkBook.Close objXL.quit MsgBox "completed"